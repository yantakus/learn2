# Migration `20200411113543-update-user`

This migration has been generated by Yan Takushevich at 4/11/2020, 11:35:43 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."User.email"

ALTER TABLE "public"."Post" DROP CONSTRAINT IF EXiSTS "Post_authorId_fkey";

ALTER TABLE "public"."User" DROP COLUMN "email",
DROP COLUMN "id",
DROP COLUMN "name",
DROP COLUMN "password",
ADD COLUMN "uid" integer  NOT NULL ;

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("uid") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200403130940-init..20200411113543-update-user
--- datamodel.dml
+++ datamodel.dml
@@ -3,23 +3,20 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Post {
   id        Int     @default(autoincrement()) @id
   title     String
   content   String?
   published Boolean @default(false)
-  author    User?   @relation(fields: [authorId], references: [id])
+  author    User?   @relation(fields: [authorId], references: [uid])
   authorId  Int?
 }
 model User {
-  id       Int     @default(autoincrement()) @id
-  email    String  @unique
-  password String
-  name     String?
-  posts    Post[]
+  uid   Int    @id
+  posts Post[]
 }
```


