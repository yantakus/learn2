# Migration `20200528112126-add-language-field-to-video`

This migration has been generated by Yan Takushevich at 5/28/2020, 11:21:26 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Language" (
"id" SERIAL,"text" text  NOT NULL ,"value" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Video" ADD COLUMN "languageId" integer  NOT NULL ;

CREATE UNIQUE INDEX "Language.value" ON "public"."Language"("value")

CREATE UNIQUE INDEX "Language.text" ON "public"."Language"("text")

ALTER TABLE "public"."Video" ADD FOREIGN KEY ("languageId")REFERENCES "public"."Language"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200527130810-remove-language-and-bookmarkers-from-video..20200528112126-add-language-field-to-video
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Video {
   ytId       String     @id
@@ -17,8 +17,10 @@
   votes      Vote[]
   voteScore  Int?       @default(0)
   uploader   User       @relation("UserVideos", fields: [uploaderId], references: [uid])
   uploaderId String
+  language   Language   @relation(fields: [languageId], references: [id])
+  languageId Int
 }
 model User {
   uid       String  @id
@@ -54,8 +56,15 @@
   text   String  @unique
   videos Video[] @relation(references: [ytId])
 }
+model Language {
+  id     Int     @default(autoincrement()) @id
+  value  String  @unique
+  text   String  @unique
+  videos Video[]
+}
+
 enum Complexity {
   ELEMENTARY
   BASIC
   ADVANCED
```


